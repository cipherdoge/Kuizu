{"ast":null,"code":"import \"core-js/modules/esnext.iterator.map.js\";\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      searchQuery: \"\",\n      searchType: \"subjects\",\n      searchResults: [],\n      searchPerformed: false\n    };\n  },\n  methods: {\n    async search() {\n      if (!this.searchQuery.trim()) {\n        alert(\"Please enter a search query.\");\n        return;\n      }\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        alert(\"Authentication token missing. Please log in.\");\n        return;\n      }\n      try {\n        const response = await axios.get(\"/api/admin/search\", {\n          params: {\n            query: this.searchQuery,\n            type: this.searchType\n          },\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n\n        // Add an \"editing\" flag for quizzes\n        this.searchResults = response.data.map(quiz => ({\n          ...quiz,\n          editing: false\n        }));\n        this.searchPerformed = true;\n      } catch (error) {\n        console.error(\"Error during search:\", error);\n        this.handleApiError(error);\n      }\n    },\n    enableEdit(index) {\n      this.$set(this.searchResults, index, {\n        ...this.searchResults[index],\n        editing: true\n      });\n    },\n    cancelEdit(index) {\n      this.$set(this.searchResults, index, {\n        ...this.searchResults[index],\n        editing: false\n      });\n    },\n    async updateQuiz(quiz, index) {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        alert(\"Authentication token missing. Please log in.\");\n        return;\n      }\n      try {\n        await axios.put(`/api/admin/updatequiz/${quiz.id}`, {\n          remarks: quiz.remarks,\n          chapter_id: quiz.chapter_id\n        }, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        alert(\"Quiz updated successfully.\");\n        this.cancelEdit(index);\n      } catch (error) {\n        console.error(\"Error updating quiz:\", error);\n        this.handleApiError(error);\n      }\n    },\n    async deleteQuiz(quizId, index) {\n      if (!confirm(\"Are you sure you want to delete this quiz?\")) return;\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        alert(\"Authentication token missing. Please log in.\");\n        return;\n      }\n      try {\n        await axios.delete(`/api/admin/deletequiz/${quizId}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        alert(\"Quiz deleted successfully.\");\n        this.searchResults.splice(index, 1); // Remove deleted quiz from UI\n      } catch (error) {\n        console.error(\"Error deleting quiz:\", error);\n        this.handleApiError(error);\n      }\n    },\n    handleApiError(error) {\n      if (error.response?.status === 401) {\n        alert(\"Unauthorized access. Please log in again.\");\n      } else if (error.response?.status === 403) {\n        alert(\"Admin access required.\");\n      } else if (error.response?.status === 422) {\n        alert(\"Invalid input.\");\n      } else {\n        alert(\"An error occurred. Please try again.\");\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","data","searchQuery","searchType","searchResults","searchPerformed","methods","search","trim","alert","token","localStorage","getItem","response","get","params","query","type","headers","Authorization","map","quiz","editing","error","console","handleApiError","enableEdit","index","$set","cancelEdit","updateQuiz","put","id","remarks","chapter_id","deleteQuiz","quizId","confirm","delete","splice","status"],"sources":["/home/ritvik/quiz_master_v2/Kuizu/frontend/src/components/ManageQuiz.vue"],"sourcesContent":["<template>\n  <div class=\"manage-quiz-container\">\n    <h1>Manage Quizzes</h1>\n\n    <!-- Search Section -->\n    <div class=\"search-section\">\n      <input\n        v-model=\"searchQuery\"\n        placeholder=\"Search users, subjects, or quizzes...\"\n        class=\"search-input\"\n      />\n      <select v-model=\"searchType\" class=\"search-select\">\n        <option value=\"users\">Users</option>\n        <option value=\"subjects\">Subjects</option>\n        <option value=\"quizzes\">Quizzes</option>\n      </select>\n      <button @click=\"search\" type=\"button\" class=\"btn btn-primary\">Search</button>\n    </div>\n\n    <!-- Search Results -->\n    <div v-if=\"searchPerformed\">\n      <h2 v-if=\"searchResults.length\">Search Results</h2>\n      <p v-else>No results found for your query.</p>\n      <div class=\"results-list\">\n        <!-- Users -->\n        <template v-if=\"searchType === 'users'\">\n          <div v-for=\"result in searchResults\" :key=\"result.id\" class=\"result-item\">\n            <p><strong>Username:</strong> {{ result.username }}</p>\n            <p><strong>Admin:</strong> {{ result.is_admin ? 'Yes' : 'No' }}</p>\n          </div>\n        </template>\n\n        <!-- Subjects -->\n        <template v-else-if=\"searchType === 'subjects'\">\n          <div v-for=\"result in searchResults\" :key=\"result.id\" class=\"result-item\">\n            <p><strong>Name:</strong> {{ result.name }}</p>\n            <p><strong>Description:</strong> {{ result.description }}</p>\n          </div>\n        </template>\n\n        <!-- Quizzes -->\n        <template v-else-if=\"searchType === 'quizzes'\">\n          <div v-for=\"(result, index) in searchResults\" :key=\"result.id\" class=\"result-item\">\n            <!-- Display Quiz Data -->\n            <div v-if=\"!result.editing\">\n              <p><strong>ID:</strong> {{ result.id }}</p>\n              <p><strong>Remarks:</strong> {{ result.remarks }}</p>\n              <p><strong>Chapter ID:</strong> {{ result.chapter_id }}</p>\n              <button @click=\"enableEdit(index)\" class=\"btn btn-warning\">Edit</button>\n              <button @click=\"deleteQuiz(result.id, index)\" class=\"btn btn-danger\">Delete</button>\n            </div>\n\n            <!-- Edit Form -->\n            <div v-else>\n              <input v-model=\"result.remarks\" placeholder=\"Edit Remarks\" class=\"edit-input\" />\n              <input v-model=\"result.chapter_id\" placeholder=\"Edit Chapter ID\" class=\"edit-input\" />\n              <button @click=\"updateQuiz(result, index)\" class=\"btn btn-success\">Save</button>\n              <button @click=\"cancelEdit(index)\" class=\"btn btn-secondary\">Cancel</button>\n            </div>\n          </div>\n        </template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  data() {\n    return {\n      searchQuery: \"\",\n      searchType: \"subjects\",\n      searchResults: [],\n      searchPerformed: false,\n    };\n  },\n  methods: {\n    async search() {\n      if (!this.searchQuery.trim()) {\n        alert(\"Please enter a search query.\");\n        return;\n      }\n\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        alert(\"Authentication token missing. Please log in.\");\n        return;\n      }\n\n      try {\n        const response = await axios.get(\"/api/admin/search\", {\n          params: {\n            query: this.searchQuery,\n            type: this.searchType,\n          },\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        });\n\n        // Add an \"editing\" flag for quizzes\n        this.searchResults = response.data.map((quiz) => ({\n          ...quiz,\n          editing: false,\n        }));\n        this.searchPerformed = true;\n      } catch (error) {\n        console.error(\"Error during search:\", error);\n        this.handleApiError(error);\n      }\n    },\n\n    enableEdit(index) {\n      this.$set(this.searchResults, index, { ...this.searchResults[index], editing: true });\n    },\n\n    cancelEdit(index) {\n      this.$set(this.searchResults, index, { ...this.searchResults[index], editing: false });\n    },\n\n    async updateQuiz(quiz, index) {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        alert(\"Authentication token missing. Please log in.\");\n        return;\n      }\n\n      try {\n        await axios.put(`/api/admin/updatequiz/${quiz.id}`, \n          { remarks: quiz.remarks, chapter_id: quiz.chapter_id }, \n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n\n        alert(\"Quiz updated successfully.\");\n        this.cancelEdit(index);\n      } catch (error) {\n        console.error(\"Error updating quiz:\", error);\n        this.handleApiError(error);\n      }\n    },\n\n    async deleteQuiz(quizId, index) {\n      if (!confirm(\"Are you sure you want to delete this quiz?\")) return;\n\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        alert(\"Authentication token missing. Please log in.\");\n        return;\n      }\n\n      try {\n        await axios.delete(`/api/admin/deletequiz/${quizId}`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n\n        alert(\"Quiz deleted successfully.\");\n        this.searchResults.splice(index, 1); // Remove deleted quiz from UI\n      } catch (error) {\n        console.error(\"Error deleting quiz:\", error);\n        this.handleApiError(error);\n      }\n    },\n\n    handleApiError(error) {\n      if (error.response?.status === 401) {\n        alert(\"Unauthorized access. Please log in again.\");\n      } else if (error.response?.status === 403) {\n        alert(\"Admin access required.\");\n      } else if (error.response?.status === 422) {\n        alert(\"Invalid input.\");\n      } else {\n        alert(\"An error occurred. Please try again.\");\n      }\n    },\n  },\n};\n</script>\n\n<style>\n.manage-quiz-container {\n  padding: 20px;\n}\n\n.search-section {\n  margin-bottom: 20px;\n}\n\n.search-input {\n  padding: 5px;\n  margin-right: 10px;\n}\n\n.search-select {\n  margin-right: 10px;\n}\n\n.results-list {\n  margin-top: 20px;\n}\n\n.result-item {\n  border: 1px solid #ddd;\n  padding: 10px;\n  margin-bottom: 10px;\n  position: relative;\n}\n\n.edit-input {\n  width: 100%;\n  padding: 5px;\n  margin-bottom: 5px;\n}\n\n.btn {\n  margin: 5px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}